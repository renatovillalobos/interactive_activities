<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Magnetic or Not</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: #f3f3f3;
      height: 100%;
      width: 100%;
      overflow: hidden;
      font-family: Arial, sans-serif;
    }
    svg {
      width: 100vw;
      height: 100vh;
      display: block;
    }
    .draggable {
      cursor: pointer;
      transition: transform 0.2s;
    }
    .drop-zone.highlight {
      stroke: #222;
      stroke-width: 4;
    }
    .result-symbol {
      opacity: 0;
      transition: opacity 0.3s ease-in-out;
    }
    .result-symbol.visible {
      opacity: 1;
    }
    #reset-btn:hover {
      cursor: pointer;
      opacity: 0.8;
    }
  </style>
</head>
<body>
<svg viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">

  <!-- Background -->
  <rect width="1200" height="800" fill="#f3f3f3"/>

  <!-- MATERIALS AREA -->
  <g id="materials">
    <g id="paper-clip" class="draggable" transform="translate(120,120)">
      <circle r="50" fill="white" stroke="#ddd" stroke-width="2"/>
      <path d="M0,-26 C12,-26 20,-15 20,0 C20,20 0,20 0,0 L0,-20" fill="none" stroke="#444" stroke-width="4" stroke-linecap="round"/>
      <g id="result-paper-clip-magnet" class="result-symbol" transform="translate(-20,-80)">
        <path d="M10,10 h20 a10,10 0 0,1 10,10 v30 h-10 v-30 h-20 v30 h-10 v-30 a10,10 0 0,1 10,-10z" fill="red" stroke="#444" stroke-width="2"/>
      </g>
      <g id="result-paper-clip-x" class="result-symbol" transform="translate(-20,-80)">
        <line x1="0" y1="0" x2="40" y2="40" stroke="#444" stroke-width="6" stroke-linecap="round"/>
        <line x1="40" y1="0" x2="0" y2="40" stroke="#444" stroke-width="6" stroke-linecap="round"/>
      </g>
    </g>

    <g id="aluminum-foil" class="draggable" transform="translate(120,280)">
      <circle r="50" fill="white" stroke="#ddd" stroke-width="2"/>
      <path d="M-15,-15 Q-12,-30,0,-20 Q12,-30,15,-15 Q30,-12,20,0 Q30,12,15,15 Q12,30,0,20 Q-12,30,-15,15 Q-30,12,-20,0 Q-30,-12,-15,-15Z" fill="none" stroke="#444" stroke-width="3"/>
      <g id="result-aluminum-foil-magnet" class="result-symbol" transform="translate(-20,-80)">
        <path d="M10,10 h20 a10,10 0 0,1 10,10 v30 h-10 v-30 h-20 v30 h-10 v-30 a10,10 0 0,1 10,-10z" fill="red" stroke="#444" stroke-width="2"/>
      </g>
      <g id="result-aluminum-foil-x" class="result-symbol" transform="translate(-20,-80)">
        <line x1="0" y1="0" x2="40" y2="40" stroke="#444" stroke-width="6" stroke-linecap="round"/>
        <line x1="40" y1="0" x2="0" y2="40" stroke="#444" stroke-width="6" stroke-linecap="round"/>
      </g>
    </g>

    <g id="plastic-bead" class="draggable" transform="translate(120,440)">
      <circle r="50" fill="white" stroke="#ddd" stroke-width="2"/>
      <circle cx="0" cy="0" r="20" fill="none" stroke="#444" stroke-width="4"/>
      <g id="result-plastic-bead-magnet" class="result-symbol" transform="translate(-20,-80)">
        <path d="M10,10 h20 a10,10 0 0,1 10,10 v30 h-10 v-30 h-20 v30 h-10 v-30 a10,10 0 0,1 10,-10z" fill="red" stroke="#444" stroke-width="2"/>
      </g>
      <g id="result-plastic-bead-x" class="result-symbol" transform="translate(-20,-80)">
        <line x1="0" y1="0" x2="40" y2="40" stroke="#444" stroke-width="6" stroke-linecap="round"/>
        <line x1="40" y1="0" x2="0" y2="40" stroke="#444" stroke-width="6" stroke-linecap="round"/>
      </g>
    </g>

    <g id="iron-nail" class="draggable" transform="translate(120,600)">
      <circle r="50" fill="white" stroke="#ddd" stroke-width="2"/>
      <line x1="0" y1="-25" x2="0" y2="20" stroke="#444" stroke-width="5" stroke-linecap="round"/>
      <line x1="-10" y1="-25" x2="10" y2="-25" stroke="#444" stroke-width="5" stroke-linecap="round"/>
      <g id="result-iron-nail-magnet" class="result-symbol" transform="translate(-20,-80)">
        <path d="M10,10 h20 a10,10 0 0,1 10,10 v30 h-10 v-30 h-20 v30 h-10 v-30 a10,10 0 0,1 10,-10z" fill="red" stroke="#444" stroke-width="2"/>
      </g>
      <g id="result-iron-nail-x" class="result-symbol" transform="translate(-20,-80)">
        <line x1="0" y1="0" x2="40" y2="40" stroke="#444" stroke-width="6" stroke-linecap="round"/>
        <line x1="40" y1="0" x2="0" y2="40" stroke="#444" stroke-width="6" stroke-linecap="round"/>
      </g>
    </g>
  </g>

  <!-- DROP AREAS -->
  <g id="dropzones">
    <g id="magnetic-zone" class="drop-zone" transform="translate(500,220)">
      <rect x="0" y="0" width="300" height="360" rx="20" fill="#d3e9f9" stroke="#ccc" stroke-width="3"/>
      <text x="150" y="-20" text-anchor="middle" font-size="28" fill="#000" font-weight="bold">Magnetic</text>
      <path d="M150,-10 v20" stroke="#444" stroke-width="3" stroke-linecap="round"/>
    </g>
    <g id="nonmagnetic-zone" class="drop-zone" transform="translate(860,220)">
      <rect x="0" y="0" width="300" height="360" rx="20" fill="#e6f2e3" stroke="#ccc" stroke-width="3"/>
      <text x="150" y="-20" text-anchor="middle" font-size="28" fill="#000" font-weight="bold">Non-Magnetic</text>
    </g>
  </g>

  <!-- RESET BUTTON -->
  <g id="reset-btn" transform="translate(540,620)">
    <rect x="0" y="0" width="120" height="50" rx="10" fill="white" stroke="#ccc" stroke-width="2"/>
    <text x="60" y="32" text-anchor="middle" font-size="20" fill="#000" font-weight="bold">Reset</text>
  </g>
</svg>

<script>
const draggables = document.querySelectorAll('.draggable');
const zones = {
  magnetic: document.getElementById('magnetic-zone'),
  nonmagnetic: document.getElementById('nonmagnetic-zone')
};
const magnetics = ['paper-clip', 'iron-nail'];
let current = null;
let offset = {x:0,y:0}

draggables.forEach(el => {
  el.addEventListener('pointerdown', e => {
    if(el.dataset.locked) return;
    const pt = el.ownerSVGElement.createSVGPoint();
    pt.x = e.clientX;
    pt.y = e.clientY;
    const ctm = el.getScreenCTM().inverse();
    const transformed = pt.matrixTransform(ctm);
    offset.x = transformed.x;
    offset.y = transformed.y;
    current = el;
    el.setPointerCapture(e.pointerId);
    el.style.transition = "transform 0s";
  });

  el.addEventListener('pointermove', e => {
    if (current !== el) return;
    const pt = el.ownerSVGElement.createSVGPoint();
    pt.x = e.clientX;
    pt.y = e.clientY;
    const ctm = el.ownerSVGElement.getScreenCTM().inverse();
    const tr = pt.matrixTransform(ctm);
    const dx = tr.x - offset.x;
    const dy = tr.y - offset.y;
    el.setAttribute('transform', `translate(${dx},${dy})`);

    highlightZone(tr.x, tr.y);
  });

  el.addEventListener('pointerup', e => {
    if (current !== el) return;
    const pt = el.ownerSVGElement.createSVGPoint();
    pt.x = e.clientX;
    pt.y = e.clientY;
    const ctm = el.ownerSVGElement.getScreenCTM().inverse();
    const tr = pt.matrixTransform(ctm);
    const id = el.id;

    let dropped = false;
    Object.entries(zones).forEach(([key, zone]) => {
      const bbox = zone.getBBox();
      const zx = +zone.getAttribute('transform').split('(')[1].split(',')[0];
      const zy = +zone.getAttribute('transform').split(',')[1].replace(')', '');
      const x = tr.x, y=tr.y;
      
      if (x > zx && x < zx + bbox.width && y > zy && y < zy + bbox.height) {
        showResult(id, key);
        el.setAttribute('transform', `translate(${zx + 150},${zy + 180})`);
        el.dataset.locked = true;
        dropped = true;
      }
    });

    if (!dropped){
      resetSingle(el);
    }

    current = null;
    clearHighlights();
  });
});

function highlightZone(x, y){
  Object.values(zones).forEach(zone => {
    const bbox = zone.getBBox();
    const zx = +zone.getAttribute('transform').split('(')[1].split(',')[0];
    const zy = +zone.getAttribute('transform').split(',')[1].replace(')', '');
    if (x > zx && x < zx + bbox.width && y > zy && y < zy + bbox.height){
      zone.classList.add('highlight');
    } else {
      zone.classList.remove('highlight');
    }
  });
}

function clearHighlights(){
  Object.values(zones).forEach(zone => zone.classList.remove('highlight'));
}

function showResult(id, zone){
  const isMag = magnetics.includes(id);
  const valid = (zone === 'magnetic' && isMag) || (zone === 'nonmagnetic' && !isMag);
  const magnetEl = document.getElementById(`result-${id}-magnet`);
  const xEl = document.getElementById(`result-${id}-x`);
  if (!magnetEl || !xEl) return;
  if (valid){
    magnetEl.classList.add('visible');
  } else {
    xEl.classList.add('visible');
  }
}

function resetSingle(el){
  const originals = {
    'paper-clip':[120,120],
    'aluminum-foil':[120,280],
    'plastic-bead':[120,440],
    'iron-nail':[120,600]
  };
  const id = el.id;
  if (!originals[id]) return;
  el.setAttribute('transform', `translate(${originals[id][0]},${originals[id][1]})`);
}

document.getElementById('reset-btn').addEventListener('click', () => {
  draggables.forEach(el => {
    const id = el.id;
    el.dataset.locked = false;
    document.getElementById(`result-${id}-magnet`).classList.remove('visible');
    document.getElementById(`result-${id}-x`).classList.remove('visible');
    resetSingle(el);
  });
});
</script>
</body>
</html>