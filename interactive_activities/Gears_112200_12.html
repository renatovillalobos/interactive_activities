<html>
<head>
<style>
html, body {
  margin: 0;
  padding: 0;
  background: radial-gradient(circle at top, #050816 0%, #020617 45%, #000000 100%);
  height: 100%;
  overflow: hidden;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", sans-serif;
}
svg {
  width: 100vmin;
  height: 100vmin;
  display: block;
  margin: auto;
}
text {
  user-select: none;
  -webkit-user-select: none;
}
</style>
</head>
<body>
<svg viewBox="0 0 1000 1000">
  <defs>
    <linearGradient id="bgGrad" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#020617"/>
      <stop offset="50%" stop-color="#050b18"/>
      <stop offset="100%" stop-color="#020617"/>
    </linearGradient>
    <linearGradient id="panelGrad" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#050b18"/>
      <stop offset="100%" stop-color="#0b1120"/>
    </linearGradient>
    <linearGradient id="accentPink" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#ff4b9a"/>
      <stop offset="100%" stop-color="#fb7185"/>
    </linearGradient>
    <linearGradient id="accentBlue" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#4f46e5"/>
      <stop offset="100%" stop-color="#3b82f6"/>
    </linearGradient>
    <linearGradient id="accentGreen" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#16a34a"/>
      <stop offset="100%" stop-color="#22c55e"/>
    </linearGradient>
    <filter id="softShadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="10" stdDeviation="20" flood-color="#000000" flood-opacity="0.6"/>
    </filter>
    <filter id="glowPink" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="6" result="blur"/>
      <feMerge>
        <feMergeNode in="blur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  </defs>

  <rect x="0" y="0" width="1000" height="1000" fill="url(#bgGrad)"/>

  <g id="mainCard" filter="url(#softShadow)">
    <rect x="80" y="70" width="840" height="860" rx="26" ry="26" fill="url(#panelGrad)" stroke="rgba(148,163,184,0.35)" stroke-width="1.5"/>

    <rect x="110" y="96" width="132" height="26" rx="12" ry="12" fill="rgba(15,23,42,0.9)" stroke="rgba(148,163,184,0.45)" stroke-width="1"/>
    <text x="176" y="114" text-anchor="middle" fill="#9ca3af" font-size="11" letter-spacing="3" style="text-transform:uppercase;">MINI LAB</text>

    <text x="110" y="160" fill="#f9fafb" font-size="26" font-weight="600">Gear Ratio Interactive Simulator</text>
    <text x="110" y="196" fill="#9ca3af" font-size="14">Explore how changing gear sizes affects rotation speed.</text>

    <rect x="110" y="226" width="780" height="184" rx="18" ry="18" fill="#020617" opacity="0.55" stroke="rgba(148,163,184,0.25)" stroke-width="1"/>
    <text x="130" y="258" fill="#9ca3af" font-size="12" letter-spacing="2.5" style="text-transform:uppercase;">How it works</text>
    <text x="130" y="288" fill="#e5e7eb" font-size="14">
      Drag one driver gear and one driven gear into the gear zone.
    </text>
    <text x="130" y="312" fill="#e5e7eb" font-size="14">
      Then press “Run” to see how the gear ratio changes rotation speed.
    </text>
    <text x="130" y="344" fill="#9ca3af" font-size="13">
      The smaller gear spins faster. Watch the arrows and ratio value update.
    </text>

    <g id="simPanel">
      <rect x="110" y="430" width="780" height="480" rx="22" ry="22" fill="#020617" stroke="rgba(148,163,184,0.35)" stroke-width="1.5"/>

      <rect x="130" y="450" width="740" height="60" rx="18" ry="18" fill="#050b18" stroke="rgba(148,163,184,0.25)" stroke-width="1"/>
      <text x="150" y="485" fill="#f9fafb" font-size="16" font-weight="600">Gear canvas</text>
      <text x="150" y="506" fill="#9ca3af" font-size="13">Build a two-gear system and compare their speeds.</text>

      <g id="dropZones">
        <g id="driverZone">
          <rect x="170" y="540" width="250" height="250" rx="22" ry="22" fill="#020617" stroke="rgba(148,163,184,0.4)" stroke-dasharray="6 6" stroke-width="1.5"/>
          <text x="295" y="572" text-anchor="middle" fill="#9ca3af" font-size="12" letter-spacing="2" style="text-transform:uppercase;">Driver gear</text>
          <text x="295" y="596" text-anchor="middle" fill="#6b7280" font-size="11">Drag a gear here</text>
        </g>
        <g id="drivenZone">
          <rect x="580" y="540" width="250" height="250" rx="22" ry="22" fill="#020617" stroke="rgba(148,163,184,0.4)" stroke-dasharray="6 6" stroke-width="1.5"/>
          <text x="705" y="572" text-anchor="middle" fill="#9ca3af" font-size="12" letter-spacing="2" style="text-transform:uppercase;">Driven gear</text>
          <text x="705" y="596" text-anchor="middle" fill="#6b7280" font-size="11">Drag a gear here</text>
        </g>
      </g>

      <g id="centerIndicators">
        <g>
          <circle cx="295" cy="665" r="4.5" fill="#4f46e5"/>
          <circle cx="295" cy="665" r="11" fill="none" stroke="rgba(59,130,246,0.6)" stroke-width="1.5"/>
        </g>
        <g>
          <circle cx="705" cy="665" r="4.5" fill="#4f46e5"/>
          <circle cx="705" cy="665" r="11" fill="none" stroke="rgba(59,130,246,0.6)" stroke-width="1.5"/>
        </g>
      </g>

      <g id="gearArrow">
        <path id="ratioArrowPath" d="M 360 665 C 420 610 580 610 640 665" fill="none" stroke="url(#accentBlue)" stroke-width="3" stroke-linecap="round"/>
        <path id="ratioArrowHead" d="M 632 653 L 648 665 L 632 677" fill="none" stroke="url(#accentBlue)" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
      </g>

      <g id="ratioPanel">
        <rect x="332" y="720" width="336" height="154" rx="18" ry="18" fill="#050b18" stroke="rgba(148,163,184,0.35)" stroke-width="1"/>
        <text x="350" y="750" fill="#9ca3af" font-size="12" letter-spacing="2" style="text-transform:uppercase;">Gear ratio</text>
        <text id="ratioText" x="350" y="786" fill="#f9fafb" font-size="26" font-weight="600">—</text>
        <text x="350" y="814" fill="#9ca3af" font-size="13">Driven speed</text>
        <text id="speedText" x="350" y="836" fill="#22c55e" font-size="15" font-weight="500">Waiting for gears…</text>

        <rect x="580" y="772" width="76" height="32" rx="16" ry="16" fill="rgba(15,23,42,0.9)" stroke="rgba(148,163,184,0.35)" stroke-width="1"/>
        <circle cx="596" cy="788" r="7" fill="none" stroke="#9ca3af" stroke-width="1.5"/>
        <path d="M592 788 L600 788" stroke="#9ca3af" stroke-width="1.5" stroke-linecap="round"/>
        <path d="M596 784 L596 792" stroke="#9ca3af" stroke-width="1.5" stroke-linecap="round"/>
        <text x="612" y="794" fill="#9ca3af" font-size="11">1 turn</text>
      </g>

      <g id="controls">
        <g id="runButton" cursor="pointer">
          <rect x="610" y="870" width="130" height="40" rx="20" ry="20" fill="url(#accentPink)" filter="url(#glowPink)"/>
          <text x="675" y="895" text-anchor="middle" fill="#fdf2f8" font-size="15" font-weight="600">Run</text>
        </g>
        <g id="resetButton" cursor="pointer">
          <rect x="470" y="872" width="112" height="36" rx="18" ry="18" fill="#020617" stroke="rgba(248,250,252,0.18)" stroke-width="1"/>
          <text x="526" y="895" text-anchor="middle" fill="#e5e7eb" font-size="14">Reset</text>
        </g>
        <g id="statusPill">
          <rect x="150" y="872" width="220" height="36" rx="18" ry="18" fill="#020617" stroke="rgba(148,163,184,0.3)" stroke-width="1"/>
          <circle id="statusDot" cx="170" cy="890" r="5" fill="#4b5563"/>
          <text id="statusText" x="186" y="895" fill="#9ca3af" font-size="13">Select two gears to begin.</text>
        </g>
      </g>

      <g id="gearTrayLabel">
        <text x="150" y="526" fill="#9ca3af" font-size="12" letter-spacing="2" style="text-transform:uppercase;">Gear options</text>
      </g>

      <g id="gearTray">
        <rect x="170" y="540" width="250" height="250" rx="22" ry="22" fill="none" stroke="none" opacity="0"/>
        <rect x="580" y="540" width="250" height="250" rx="22" ry="22" fill="none" stroke="none" opacity="0"/>

        <g id="paletteArea">
          <rect x="170" y="540" width="660" height="90" rx="18" ry="18" fill="#050b18" stroke="rgba(148,163,184,0.25)" stroke-width="1"/>

          <g id="paletteGear40" class="paletteGear" cursor="pointer">
            <circle cx="250" cy="585" r="34" fill="#020617" stroke="#64748b" stroke-width="2"/>
            <path d="M250 545 L250 555 M250 615 L250 625 M210 585 L220 585 M280 585 L290 585 M225 560 L232 567 M268 603 L275 610 M268 567 L275 560 M225 610 L232 603" stroke="#64748b" stroke-width="2" stroke-linecap="round"/>
            <circle cx="250" cy="585" r="10" fill="none" stroke="#94a3b8" stroke-width="1.5"/>
            <text x="250" y="590" text-anchor="middle" fill="#e5e7eb" font-size="12" font-weight="600">40</text>
          </g>

          <g id="paletteGear24" class="paletteGear" cursor="pointer">
            <circle cx="380" cy="585" r="30" fill="#020617" stroke="#64748b" stroke-width="2"/>
            <path d="M380 551 L380 558 M380 612 L380 619 M346 585 L353 585 M407 585 L414 585 M357 562 L362 567 M398 603 L403 608 M398 567 L403 562 M357 608 L362 603" stroke="#64748b" stroke-width="2" stroke-linecap="round"/>
            <circle cx="380" cy="585" r="9" fill="none" stroke="#94a3b8" stroke-width="1.5"/>
            <text x="380" y="590" text-anchor="middle" fill="#e5e7eb" font-size="12" font-weight="600">24</text>
          </g>

          <g id="paletteGear15" class="paletteGear" cursor="pointer">
            <circle cx="510" cy="585" r="26" fill="#020617" stroke="#64748b" stroke-width="2"/>
            <path d="M510 555 L510 561 M510 609 L510 615 M480 585 L486 585 M534 585 L540 585 M491 566 L495 570 M525 600 L529 604 M525 570 L529 566 M491 604 L495 600" stroke="#64748b" stroke-width="2" stroke-linecap="round"/>
            <circle cx="510" cy="585" r="8" fill="none" stroke="#94a3b8" stroke-width="1.5"/>
            <text x="510" y="590" text-anchor="middle" fill="#e5e7eb" font-size="12" font-weight="600">15</text>
          </g>

          <g id="paletteGear10" class="paletteGear" cursor="pointer">
            <circle cx="640" cy="585" r="22" fill="#020617" stroke="#64748b" stroke-width="2"/>
            <path d="M640 563 L640 568 M640 602 L640 607 M618 585 L623 585 M657 585 L662 585 M625 570 L628 573 M652 597 L655 600 M652 573 L655 570 M625 600 L628 597" stroke="#64748b" stroke-width="2" stroke-linecap="round"/>
            <circle cx="640" cy="585" r="7" fill="none" stroke="#94a3b8" stroke-width="1.5"/>
            <text x="640" y="590" text-anchor="middle" fill="#e5e7eb" font-size="12" font-weight="600">10</text>
          </g>
        </g>
      </g>
    </g>
  </g>

  <g id="draggableGears"></g>

  <script>
  const svg = document.querySelector('svg');
  const NS = "http://www.w3.org/2000/svg";

  const driverZoneRect = {x:170,y:540,w:250,h:250};
  const drivenZoneRect = {x:580,y:540,w:250,h:250};
  const driverCenter = {x:295,y:665};
  const drivenCenter = {x:705,y:665};

  const statusDot = document.getElementById('statusDot');
  const statusText = document.getElementById('statusText');
  const ratioText = document.getElementById('ratioText');
  const speedText = document.getElementById('speedText');
  const runButton = document.getElementById('runButton');
  const resetButton = document.getElementById('resetButton');
  const arrowPath = document.getElementById('ratioArrowPath');
  const arrowHead = document.getElementById('ratioArrowHead');

  let dragging = null;
  let offset = {x:0,y:0};
  let activeDriver = null;
  let activeDriven = null;
  let driverTeeth = null;
  let drivenTeeth = null;

  function setStatus(message, color) {
    statusText.textContent = message;
    statusDot.setAttribute('fill', color);
  }

  function clonePaletteGear(paletteNode) {
    const teeth = parseInt(paletteNode.querySelector('text').textContent,10);
    const clone = document.createElementNS(NS,'g');
    clone.setAttribute('class','draggableGear');
    clone.setAttribute('data-teeth', teeth);
    clone.style.cursor = 'pointer';

    const baseCircle = paletteNode.querySelector('circle');
    const r = parseFloat(baseCircle.getAttribute('r'));
    const gearFill = '#020617';
    const gearStroke = '#e5e7eb';

    const outer = document.createElementNS(NS,'circle');
    outer.setAttribute('cx', 0);
    outer.setAttribute('cy', 0);
    outer.setAttribute('r', r);
    outer.setAttribute('fill', gearFill);
    outer.setAttribute('stroke', gearStroke);
    outer.setAttribute('stroke-width', 2);
    clone.appendChild(outer);

    const toothLines = [
      [0,-r,0,-r*0.8],
      [0,r,0,r*0.8],
      [-r,0,-r*0.8,0],
      [r,0,r*0.8,0],
      [-r*0.7,-r*0.7,-r*0.5,-r*0.5],
      [r*0.7,r*0.7,r*0.5,r*0.5],
      [r*0.7,-r*0.7,r*0.5,-r*0.5],
      [-r*0.7,r*0.7,-r*0.5,r*0.5]
    ];
    toothLines.forEach(l=>{
      const p = document.createElementNS(NS,'path');
      p.setAttribute('d',`M${l[0]} ${l[1]} L${l[2]} ${l[3]}`);
      p.setAttribute('stroke','#e5e7eb');
      p.setAttribute('stroke-width',2);
      p.setAttribute('stroke-linecap','round');
      clone.appendChild(p);
    });

    const inner = document.createElementNS(NS,'circle');
    inner.setAttribute('cx',0);
    inner.setAttribute('cy',0);
    inner.setAttribute('r', r*0.32);
    inner.setAttribute('fill','none');
    inner.setAttribute('stroke','#94a3b8');
    inner.setAttribute('stroke-width',1.5);
    clone.appendChild(inner);

    const label = document.createElementNS(NS,'text');
    label.setAttribute('x',0);
    label.setAttribute('y',4);
    label.setAttribute('text-anchor','middle');
    label.setAttribute('fill','#f9fafb');
    label.setAttribute('font-size',12);
    label.setAttribute('font-weight','600');
    label.textContent = teeth;
    clone.appendChild(label);

    const trayPos = paletteNode.querySelector('circle');
    const cx = parseFloat(trayPos.getAttribute('cx'));
    const cy = parseFloat(trayPos.getAttribute('cy'));
    const {x,y} = svg.createSVGPoint().matrixTransform(svg.getScreenCTM().inverse());
    clone.setAttribute('transform',`translate(${cx},${cy})`);

    document.getElementById('draggableGears').appendChild(clone);
    enableDrag(clone);
  }

  function enableDrag(gear) {
    gear.addEventListener('mousedown',startDrag);
    gear.addEventListener('touchstart',startDrag,{passive:false});
  }

  function getEventPoint(evt) {
    const point = svg.createSVGPoint();
    if (evt.touches && evt.touches.length) {
      point.x = evt.touches[0].clientX;
      point.y = evt.touches[0].clientY;
    } else {
      point.x = evt.clientX;
      point.y = evt.clientY;
    }
    const ctm = svg.getScreenCTM().inverse();
    return point.matrixTransform(ctm);
  }

  function startDrag(evt) {
    evt.preventDefault();
    const target = evt.currentTarget;
    dragging = target;
    const pt = getEventPoint(evt);
    const transform = target.getAttribute('transform') || 'translate(0,0)';
    const match = /translate\(([-0-9.]+),\s*([-0-9.]+)\)/.exec(transform);
    const gx = match ? parseFloat(match[1]) : 0;
    const gy = match ? parseFloat(match[2]) : 0;
    offset.x = pt.x - gx;
    offset.y = pt.y - gy;
    svg.addEventListener('mousemove',dragMove);
    svg.addEventListener('touchmove',dragMove,{passive:false});
    svg.addEventListener('mouseup',endDrag);
    svg.addEventListener('touchend',endDrag);
  }

  function dragMove(evt) {
    if (!dragging) return;
    evt.preventDefault();
    const pt = getEventPoint(evt);
    const nx = pt.x - offset.x;
    const ny = pt.y - offset.y;
    dragging.setAttribute('transform',`translate(${nx},${ny}) scale(1.02)`);
  }

  function insideZone(x,y,zone) {
    return x>zone.x && x<zone.x+zone.w && y>zone.y && y<zone.y+zone.h;
  }

  function endDrag(evt) {
    if (!dragging) return;
    const pt = getEventPoint(evt);
    const teeth = parseInt(dragging.getAttribute('data-teeth'),10);

    if (insideZone(pt.x,pt.y,driverZoneRect) && (!activeDriver || activeDriver===dragging)) {
      dragging.setAttribute('transform',`translate(${driverCenter.x},${driverCenter.y})`);
      activeDriver = dragging;
      driverTeeth = teeth;
    } else if (insideZone(pt.x,pt.y,drivenZoneRect) && (!activeDriven || activeDriven===dragging)) {
      dragging.setAttribute('transform',`translate(${drivenCenter.x},${drivenCenter.y})`);
      activeDriven = dragging;
      drivenTeeth = teeth;
    } else {
      dragging.parentNode.removeChild(dragging);
    }

    dragging = null;
    svg.removeEventListener('mousemove',dragMove);
    svg.removeEventListener('touchmove',dragMove);
    svg.removeEventListener('mouseup',endDrag);
    svg.removeEventListener('touchend',endDrag);

    if (driverTeeth && drivenTeeth) {
      setStatus('Press Run to compare their speeds.', '#22c55e');
    } else if (driverTeeth || drivenTeeth) {
      setStatus('Add the second gear to continue.', '#eab308');
    } else {
      setStatus('Select two gears to begin.', '#4b5563');
    }
  }

  document.querySelectorAll('.paletteGear').forEach(p=>{
    p.addEventListener('click',()=>clonePaletteGear(p));
  });

  function animateRotation(group, turns, duration) {
    if (!group) return;
    const start = performance.now();
    const teeth = parseInt(group.getAttribute('data-teeth'),10) || 1;
    const maxAngle = 360*turns;
    function frame(now) {
      const t = Math.min(1,(now-start)/duration);
      const angle = maxAngle*t;
      group.setAttribute('transform',`translate(${group===activeDriver?driverCenter.x:drivenCenter.x},${group===activeDriver?driverCenter.y:drivenCenter.y}) rotate(${angle})`);
      if (t<1) requestAnimationFrame(frame);
    }
    requestAnimationFrame(frame);
  }

  runButton.addEventListener('mousedown',()=>runButtonScale(0.95));
  runButton.addEventListener('mouseup',()=>runButtonScale(1));
  runButton.addEventListener('mouseleave',()=>runButtonScale(1));
  runButton.addEventListener('click',runSim);
  runButton.addEventListener('touchstart',e=>{e.preventDefault();runButtonScale(0.95);runSim();});
  runButton.addEventListener('touchend',()=>runButtonScale(1));

  function runButtonScale(s) {
    runButton.setAttribute('transform',`scale(${s}) translate(${s===1?0:32/s},${s===1?0:43/s})`);
  }

  function runSim() {
    if (!(driverTeeth && drivenTeeth)) {
      setStatus('Place one gear in each zone first.', '#f97316');
      return;
    }
    const ratio = (driverTeeth/drivenTeeth).toFixed(2);
    ratioText.textContent = `1 : ${ratio}`;
    const faster = driverTeeth>drivenTeeth?'Driven gear spins faster.':'Driver gear spins faster.';
    speedText.textContent = faster;
    setStatus('Watch how fast the driven gear turns.', '#22c55e');

    animateRotation(activeDriver,1,900);
    animateRotation(activeDriven,driverTeeth/drivenTeeth,900);

    arrowPath.style.transition = 'stroke 0.3s ease';
    arrowHead.style.transition = 'stroke 0.3s ease';
    arrowPath.setAttribute('stroke','url(#accentGreen)');
    arrowHead.setAttribute('stroke','url(#accentGreen)');
    setTimeout(()=>{
      arrowPath.setAttribute('stroke','url(#accentBlue)');
      arrowHead.setAttribute('stroke','url(#accentBlue)');
    },400);
  }

  resetButton.addEventListener('click',resetAll);
  resetButton.addEventListener('touchstart',e=>{e.preventDefault();resetAll();});

  function resetAll() {
    document.querySelectorAll('#draggableGears > g').forEach(g=>g.remove());
    activeDriver=null;
    activeDriven=null;
    driverTeeth=null;
    drivenTeeth=null;
    ratioText.textContent='—';
    speedText.textContent='Waiting for gears…';
    setStatus('Select two gears to begin.', '#4b5563');
  }
  </script>
</svg>
</body>
</html>