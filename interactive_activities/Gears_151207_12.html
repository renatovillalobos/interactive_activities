<html>
<head>
<style>
html,body{
  margin:0;
  padding:0;
  height:100%;
  width:100%;
  background:#f5f5f5;
}
#container{
  width:100vmin;
  height:100vmin;
  margin:0 auto;
  display:block;
}
svg{
  width:100%;
  height:100%;
}
text{
  font-family: Arial, sans-serif;
}
</style>
</head>
<body>
<svg id="labSVG" viewBox="0 0 800 800">
  <rect x="0" y="0" width="800" height="800" fill="#ffffff"/>

  <rect x="40" y="40" width="720" height="80" rx="12" ry="12" fill="#f0f4ff" stroke="#c1c9f5" stroke-width="2"/>
  <text x="60" y="90" font-size="30" fill="#1b2950">Gear Ratio Experiment: Fast vs. Slow</text>

  <rect x="40" y="140" width="480" height="200" rx="12" ry="12" fill="#fdf7e3" stroke="#f2d28b" stroke-width="2"/>
  <text x="60" y="175" font-size="20" fill="#5b4a1a">Goal</text>
  <text x="60" y="205" font-size="16" fill="#333333">Understand how the number of gear teeth</text>
  <text x="60" y="230" font-size="16" fill="#333333">affects rotation speed.</text>

  <rect x="540" y="140" width="220" height="200" rx="12" ry="12" fill="#e7f7ff" stroke="#99cce8" stroke-width="2"/>
  <text x="560" y="175" font-size="18" fill="#14516b">Materials</text>
  <text x="560" y="205" font-size="14" fill="#333333">• Cardboard</text>
  <text x="560" y="225" font-size="14" fill="#333333">• Markers</text>
  <text x="560" y="245" font-size="14" fill="#333333">• Pushpins</text>
  <text x="560" y="265" font-size="14" fill="#333333">• String</text>
  <text x="560" y="285" font-size="14" fill="#333333">• Small gears</text>

  <rect x="40" y="360" width="720" height="90" rx="12" ry="12" fill="#eef2ff" stroke="#ccd3ff" stroke-width="2"/>
  <text x="60" y="395" font-size="20" fill="#1b2950">Try it:</text>
  <text x="140" y="395" font-size="18" fill="#333333">Drag a gear onto a peg, then turn the handle.</text>
  <text x="140" y="420" font-size="16" fill="#555555">Compare how fast the large gears spin.</text>

  <rect x="60" y="470" width="320" height="260" rx="14" ry="14" fill="#f8fbff" stroke="#cfd5e6" stroke-width="2"/>
  <text x="90" y="505" font-size="18" fill="#1b2950">Gear Box A</text>

  <circle cx="180" cy="615" r="18" fill="#ffffff" stroke="#b0b7c8" stroke-width="3"/>
  <circle cx="180" cy="615" r="5" fill="#b0b7c8"/>
  <rect x="170" y="640" width="20" height="45" rx="4" ry="4" fill="#dbe1f2" stroke="#9aa4c1" stroke-width="2"/>

  <path d="M260 565 L340 565 L340 665 L260 665 Z" fill="#f2f4ff" stroke="#c3c7e0" stroke-width="2"/>

  <circle cx="300" cy="615" r="45" fill="#ffffff" stroke="#b0b7c8" stroke-width="3"/>
  <circle cx="300" cy="615" r="8" fill="#b0b7c8"/>
  <path d="M300 570 L300 580" stroke="#b0b7c8" stroke-width="3"/>
  <path d="M300 650 L300 640" stroke="#b0b7c8" stroke-width="3"/>
  <path d="M255 615 L265 615" stroke="#b0b7c8" stroke-width="3"/>
  <path d="M345 615 L335 615" stroke="#b0b7c8" stroke-width="3"/>

  <rect x="420" y="470" width="320" height="260" rx="14" ry="14" fill="#f8fbff" stroke="#cfd5e6" stroke-width="2"/>
  <text x="450" y="505" font-size="18" fill="#1b2950">Gear Box B</text>

  <circle cx="540" cy="615" r="18" fill="#ffffff" stroke="#b0b7c8" stroke-width="3"/>
  <circle cx="540" cy="615" r="5" fill="#b0b7c8"/>
  <rect x="530" y="640" width="20" height="45" rx="4" ry="4" fill="#dbe1f2" stroke="#9aa4c1" stroke-width="2"/>

  <path d="M620 565 L700 565 L700 665 L620 665 Z" fill="#f2f4ff" stroke="#c3c7e0" stroke-width="2"/>

  <circle cx="660" cy="615" r="45" fill="#ffffff" stroke="#b0b7c8" stroke-width="3"/>
  <circle cx="660" cy="615" r="8" fill="#b0b7c8"/>
  <path d="M660 570 L660 580" stroke="#b0b7c8" stroke-width="3"/>
  <path d="M660 650 L660 640" stroke="#b0b7c8" stroke-width="3"/>
  <path d="M615 615 L625 615" stroke="#b0b7c8" stroke-width="3"/>
  <path d="M705 615 L695 615" stroke="#b0b7c8" stroke-width="3"/>

  <rect x="60" y="720" width="680" height="40" rx="10" ry="10" fill="#e9ecf7" stroke="#c3c7e0" stroke-width="1.5"/>
  <text x="80" y="746" font-size="16" fill="#333333">Which box has the larger gear spinning faster?</text>
  <text x="555" y="746" font-size="16" fill="#333333">A</text>
  <text x="635" y="746" font-size="16" fill="#333333">B</text>

  <g id="pegA">
    <circle cx="180" cy="615" r="24" fill="transparent"/>
  </g>

  <g id="pegB">
    <circle cx="540" cy="615" r="24" fill="transparent"/>
  </g>

  <g id="gearSmall" cursor="pointer">
    <circle cx="120" cy="310" r="30" fill="#ffe8bf" stroke="#d6a85f" stroke-width="3"/>
    <circle cx="120" cy="310" r="8" fill="#d6a85f"/>
    <text x="120" y="315" font-size="14" text-anchor="middle" fill="#5b4a1a">12</text>
  </g>

  <g id="gearLarge" cursor="pointer">
    <circle cx="240" cy="310" r="40" fill="#ffd0d0" stroke="#d68080" stroke-width="3"/>
    <circle cx="240" cy="310" r="8" fill="#d68080"/>
    <text x="240" y="315" font-size="14" text-anchor="middle" fill="#5b1a1a">24</text>
  </g>

  <g id="handleA" cursor="pointer">
    <rect x="170" y="640" width="20" height="45" rx="4" ry="4" fill="transparent"/>
  </g>

  <g id="handleB" cursor="pointer">
    <rect x="530" y="640" width="20" height="45" rx="4" ry="4" fill="transparent"/>
  </g>

  <g id="buttonA" cursor="pointer">
    <rect x="540" y="730" width="40" height="22" rx="6" ry="6" fill="#ffffff" stroke="#9aa4c1" stroke-width="1.5"/>
  </g>

  <g id="buttonB" cursor="pointer">
    <rect x="620" y="730" width="40" height="22" rx="6" ry="6" fill="#ffffff" stroke="#9aa4c1" stroke-width="1.5"/>
  </g>

  <g id="checkButton" cursor="pointer">
    <rect x="360" y="730" width="120" height="30" rx="8" ry="8" fill="#4b6cff" stroke="#3246b3" stroke-width="1.5"/>
    <text x="420" y="751" font-size="16" text-anchor="middle" fill="#ffffff">Check</text>
  </g>

  <text id="feedbackText" x="260" y="705" font-size="18" text-anchor="middle" fill="#28a745" opacity="0">Correct!</text>
  <text id="feedbackTextWrong" x="260" y="705" font-size="18" text-anchor="middle" fill="#d63031" opacity="0">Try again.</text>
</svg>
<script>
(function(){
  var svg=document.getElementById("labSVG");
  var gearSmall=document.getElementById("gearSmall");
  var gearLarge=document.getElementById("gearLarge");
  var pegA=document.getElementById("pegA");
  var pegB=document.getElementById("pegB");
  var handleA=document.getElementById("handleA");
  var handleB=document.getElementById("handleB");
  var buttonA=document.getElementById("buttonA");
  var buttonB=document.getElementById("buttonB");
  var checkButton=document.getElementById("checkButton");
  var feedbackText=document.getElementById("feedbackText");
  var feedbackTextWrong=document.getElementById("feedbackTextWrong");

  var selectedAnswer=null;
  var boxAGear=null;
  var boxBGear=null;

  function getPoint(evt){
    var pt=svg.createSVGPoint();
    pt.x=(evt.touches?evt.touches[0].clientX:evt.clientX);
    pt.y=(evt.touches?evt.touches[0].clientY:evt.clientY);
    return pt.matrixTransform(svg.getScreenCTM().inverse());
  }

  function makeDraggable(gear,name){
    var dragging=false;
    var offset={x:0,y:0};
    var home={x:gear.transform.baseVal.consolidate()?0:0,y:gear.transform.baseVal.consolidate()?0:0};
    var initialMatrix=gear.transform.baseVal.numberOfItems?gear.transform.baseVal.getItem(0).matrix:null;
    if(!initialMatrix){
      var t=svg.createSVGTransform();
      t.setTranslate(0,0);
      gear.transform.baseVal.appendItem(t);
      initialMatrix=gear.transform.baseVal.getItem(0).matrix;
    }
    home.x=initialMatrix.e;
    home.y=initialMatrix.f;

    function start(evt){
      evt.preventDefault();
      dragging=true;
      var p=getPoint(evt);
      offset.x=p.x-initialMatrix.e;
      offset.y=p.y-initialMatrix.f;
      gear.style.transition="none";
    }
    function move(evt){
      if(!dragging)return;
      evt.preventDefault();
      var p=getPoint(evt);
      var nx=p.x-offset.x;
      var ny=p.y-offset.y;
      var t=gear.transform.baseVal.getItem(0);
      t.setTranslate(nx,ny);
    }
    function end(evt){
      if(!dragging)return;
      dragging=false;
      var p=getPoint(evt);
      var placed=false;

      function snapTo(peg,box){
        var c=peg.querySelector("circle");
        var cx=parseFloat(c.getAttribute("cx"));
        var cy=parseFloat(c.getAttribute("cy"));
        var dx=p.x-cx;
        var dy=p.y-cy;
        var dist=Math.sqrt(dx*dx+dy*dy);
        if(dist<40){
          var t=gear.transform.baseVal.getItem(0);
          t.setTranslate(cx-parseFloat(gear.querySelector("circle").getAttribute("cx")),cy-parseFloat(gear.querySelector("circle").getAttribute("cy")));
          if(box==="A")boxAGear=name;
          if(box==="B")boxBGear=name;
          placed=true;
        }
      }

      snapTo(pegA,"A");
      if(!placed)snapTo(pegB,"B");

      if(!placed){
        var t=gear.transform.baseVal.getItem(0);
        t.setTranslate(home.x,home.y);
        if(boxAGear===name)boxAGear=null;
        if(boxBGear===name)boxBGear=null;
      }
      gear.style.transition="transform 0.2s";
    }

    gear.addEventListener("mousedown",start);
    svg.addEventListener("mousemove",move);
    window.addEventListener("mouseup",end);
    gear.addEventListener("touchstart",start,{passive:false});
    svg.addEventListener("touchmove",move,{passive:false});
    window.addEventListener("touchend",end);
  }

  function setInitialTransforms(){
    var t1=svg.createSVGTransform();
    t1.setTranslate(0,0);
    gearSmall.transform.baseVal.appendItem(t1);
    var t2=svg.createSVGTransform();
    t2.setTranslate(0,0);
    gearLarge.transform.baseVal.appendItem(t2);
  }
  setInitialTransforms();
  makeDraggable(gearSmall,"small");
  makeDraggable(gearLarge,"large");

  function rotateGear(centerX,centerY,targetId,speedFactor){
    var gear=document.getElementById(targetId);
    if(!gear)return;
    var angle=0;
    var running=true;
    gear.style.transition="none";
    function step(){
      if(!running)return;
      angle+=speedFactor;
      var t=gear.transform.baseVal.consolidate();
      var m=t? t.matrix:svg.createSVGMatrix();
      var base=gear.id==="gearSmall"||gear.id==="gearLarge"?0:0;
      var cxOrig=parseFloat(gear.querySelector("circle").getAttribute("cx"));
      var cyOrig=parseFloat(gear.querySelector("circle").getAttribute("cy"));
      var tx=m.e;
      var ty=m.f;
      gear.setAttribute("transform","translate("+tx+","+ty+") rotate("+angle+" "+cxOrig+" "+cyOrig+")");
      requestAnimationFrame(step);
    }
    step();
    setTimeout(function(){running=false;},1200);
  }

  function spinBox(box){
    if(box==="A"){
      if(!boxAGear)return;
      var speedSmall=10;
      var speedLarge=5;
      if(boxAGear==="small"){
        rotateGear(180,615,"gearSmall",speedSmall);
        rotateGear(300,615,"",speedLarge);
      }else{
        rotateGear(180,615,"gearLarge",speedSmall);
        rotateGear(300,615,"",speedLarge);
      }
    }
    if(box==="B"){
      if(!boxBGear)return;
      var speedSmall=10;
      var speedLarge=5;
      if(boxBGear==="small"){
        rotateGear(540,615,"gearSmall",speedSmall);
        rotateGear(660,615,"",speedLarge);
      }else{
        rotateGear(540,615,"gearLarge",speedSmall);
        rotateGear(660,615,"",speedLarge);
      }
    }
  }

  handleA.addEventListener("click",function(){spinBox("A");});
  handleB.addEventListener("click",function(){spinBox("B");});

  function selectButton(which){
    selectedAnswer=which;
    buttonA.querySelector("rect").setAttribute("fill",which==="A"?"#4b6cff":"#ffffff");
    buttonA.querySelector("rect").setAttribute("stroke",which==="A"?"#3246b3":"#9aa4c1");
    buttonB.querySelector("rect").setAttribute("fill",which==="B"?"#4b6cff":"#ffffff");
    buttonB.querySelector("rect").setAttribute("stroke",which==="B"?"#3246b3":"#9aa4c1");
  }
  buttonA.addEventListener("click",function(){selectButton("A");});
  buttonB.addEventListener("click",function(){selectButton("B");});

  function showFeedback(correct){
    feedbackText.setAttribute("opacity",correct?1:0);
    feedbackTextWrong.setAttribute("opacity",correct?0:1);
    setTimeout(function(){
      feedbackText.setAttribute("opacity",0);
      feedbackTextWrong.setAttribute("opacity",0);
    },1200);
  }

  checkButton.addEventListener("click",function(){
    if(!selectedAnswer)return;
    var correct=false;
    if(boxAGear==="small"&&boxBGear==="large"){
      correct=(selectedAnswer==="A");
    }else if(boxAGear==="large"&&boxBGear==="small"){
      correct=(selectedAnswer==="B");
    }
    showFeedback(correct);
  });
})();
</script>
</body>
</html>