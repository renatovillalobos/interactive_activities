<html>
<head>
  <meta charset="UTF-8">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: #f7f3ec;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }
    svg {
      width: 100%;
      height: 100%;
      display: block;
    }
    .glow {
      filter: drop-shadow(0 0 6px #80caff);
    }
    .transition {
      transition: transform 0.25s ease, filter 0.25s ease;
    }
  </style>
</head>
<body>
<svg viewBox="0 0 1200 1000" xmlns="http://www.w3.org/2000/svg">

  <!-- Background line for surface -->
  <line x1="150" y1="880" x2="1050" y2="880" stroke="#dcd9d2" stroke-width="8"/>

  <!-- Ruler -->
  <g id="ruler">
    <rect x="100" y="220" width="40" height="500" rx="20" ry="20" fill="#e8e6e4"/>
    <g stroke="#8aa2c1" stroke-width="4">
      <line x1="130" y1="240" x2="160" y2="240"/>
      <line x1="130" y1="270" x2="160" y2="270"/>
      <line x1="130" y1="300" x2="160" y2="300"/>
      <line x1="130" y1="330" x2="160" y2="330"/>
      <line x1="130" y1="360" x2="160" y2="360"/>
      <line x1="130" y1="390" x2="160" y2="390"/>
      <line x1="130" y1="420" x2="160" y2="420"/>
      <line x1="130" y1="450" x2="160" y2="450"/>
      <line x1="130" y1="480" x2="160" y2="480"/>
      <line x1="130" y1="510" x2="160" y2="510"/>
      <line x1="130" y1="540" x2="160" y2="540"/>
      <line x1="130" y1="570" x2="160" y2="570"/>
      <line x1="130" y1="600" x2="160" y2="600"/>
      <line x1="130" y1="630" x2="160" y2="630"/>
      <line x1="130" y1="660" x2="160" y2="660"/>
    </g>
  </g>

  <!-- Spring -->
  <g id="spring" transform="translate(600,200)">
    <path id="spring-line" d="M0,-80
        Q10,-75 0,-70
        Q-10,-65 0,-60
        Q10,-55 0,-50
        Q-10,-45 0,-40
        Q10,-35 0,-30
        Q-10,-25 0,-20
        Q10,-15 0,-10
        Q-10,-5 0,0
        Q10,5 0,10
        Q-10,15 0,20
        Q10,25 0,30
        Q-10,35 0,40
        Q10,45 0,50
        Q-10,55 0,60
        Q10,65 0,70
        Q-10,75 0,80
        Q10,85 0,90
        V130"
      fill="none" stroke="#5dbaf7" stroke-width="10" stroke-linecap="round"/>
    <circle id="spring-hook" cx="0" cy="150" r="25" fill="none" stroke="#5dbaf7" stroke-width="10" />
  </g>

  <!-- Arrow above spring -->
  <g stroke="#5dbaf7" stroke-width="10" fill="none" transform="translate(600,100)">
    <path d="M0,0 C40,-30 80,-30 120,0"/>
    <path d="M120,0 l-25,-10 l10,25"/>
  </g>

  <!-- Object Tray -->
  <g id="tray">
    <g id="object1" class="transition" transform="translate(260,820)" cursor="grab">
      <rect x="0" y="0" width="70" height="70" rx="18" ry="18" fill="#fcd489"/>
    </g>
    <g id="object2" class="transition" transform="translate(380,800)" cursor="grab">
      <rect x="0" y="0" width="100" height="100" rx="22" ry="22" fill="#f89353"/>
    </g>
    <g id="object3" class="transition" transform="translate(530,770)" cursor="grab">
      <rect x="0" y="0" width="130" height="130" rx="26" ry="26" fill="#fc9249"/>
    </g>
    <g id="object4" class="transition" transform="translate(710,695)" cursor="grab">
      <rect x="0" y="0" width="140" height="190" rx="30" ry="30" fill="#52a8c3"/>
    </g>
  </g>

  <!-- Reset Button -->
  <g id="reset" transform="translate(1050,920)" cursor="pointer">
    <rect x="0" y="0" width="100" height="100" rx="20" ry="20" fill="#49aaf0"/>
    <path d="M50,28 A22,22 0 1,1 28,50" fill="none" stroke="#ffffff" stroke-width="6"/>
    <polyline points="28,38 28,52 42,52" fill="none" stroke="#ffffff" stroke-width="6" stroke-linecap="round" stroke-linejoin="round"/>
  </g>

</svg>

<script>
  const objects = ["object1", "object2", "object3", "object4"];
  const spring = document.getElementById("spring");
  const hook = document.getElementById("spring-hook");
  const reset = document.getElementById("reset");

  const springLine = document.getElementById("spring-line");

  const defaultPositions = {
    object1: { x: 260, y: 820 },
    object2: { x: 380, y: 800 },
    object3: { x: 530, y: 770 },
    object4: { x: 710, y: 695 }
  };

  const objectMasses = {
    object1: 20,
    object2: 40,
    object3: 60,
    object4: 80
  };

  const springK = 10;
  const hookPosition = { x: 600, y: 350 };
  let currentObject = null;
  let offsetX = 0;
  let offsetY = 0;
  let snapped = false;

  objects.forEach(id => {
    const el = document.getElementById(id);
    el.addEventListener("pointerdown", e => {
      currentObject = el;
      el.classList.add("glow");
      const ctm = el.getScreenCTM();
      offsetX = e.clientX - ctm.e;
      offsetY = e.clientY - ctm.f;
      document.addEventListener("pointermove", onMove);
      document.addEventListener("pointerup", onUp);
    });
    el.addEventListener("pointerenter", () => {
      el.classList.add("glow");
    });
    el.addEventListener("pointerleave", () => {
      if (currentObject !== el) el.classList.remove("glow");
    });
  });

  function onMove(e) {
    if (!currentObject) return;
    const svg = document.querySelector("svg");
    const pt = svg.createSVGPoint();
    pt.x = e.clientX - offsetX;
    pt.y = e.clientY - offsetY;
    const transformed = pt.matrixTransform(svg.getScreenCTM().inverse());
    currentObject.setAttribute("transform", `translate(${transformed.x},${transformed.y})`);
  }

  function onUp(e) {
    if (!currentObject) return;
    const bbox = currentObject.getBoundingClientRect();
    const hookBox = hook.getBoundingClientRect();
    const dist = Math.hypot(
      bbox.x + bbox.width / 2 - (hookBox.x + hookBox.width / 2),
      bbox.y + bbox.height / 2 - (hookBox.y + hookBox.height / 2)
    );

    if (dist < 50) {
      const id = currentObject.id;
      const x = hookPosition.x - parseInt(currentObject.querySelector("rect").getAttribute("width")) / 2;
      const y = hookPosition.y + objectMasses[id];
      simulateSpringStretch(objectMasses[id]);
      currentObject.setAttribute("transform", `translate(${x},${y})`);
      currentObject.setAttribute("data-snapped", "true");
      snapped = true;
    }

    currentObject.classList.remove("glow");
    currentObject = null;
    document.removeEventListener("pointermove", onMove);
    document.removeEventListener("pointerup", onUp);
  }

  function simulateSpringStretch(mass) {
    const displacement = mass / springK;
    let original = springLine.getAttribute("d");
    let stretch = 40 + displacement * 10;
    let d = `
      M0,-80
      Q10,-75 0,-70
      Q-10,-65 0,-60
      Q10,-55 0,-50
      Q-10,-45 0,-40
      Q10,-35 0,-30
      Q-10,-25 0,-20
      Q10,-15 0,-10
      Q-10,-5 0,0
      Q10,5 0,10
      Q-10,15 0,20
      Q10,25 0,30
      Q-10,35 0,40
      Q10,45 0,50
      Q-10,55 0,60
      Q10,65 0,70
      Q-10,75 0,80
      Q10,85 0,${stretch}
      V${stretch + 40}
    `;
    springLine.setAttribute("d", d);
  }

  reset.addEventListener("click", () => {
    objects.forEach(id => {
      const el = document.getElementById(id);
      const pos = defaultPositions[id];
      el.setAttribute("transform", `translate(${pos.x},${pos.y})`);
      el.removeAttribute("data-snapped");
    });
    springLine.setAttribute("d", `
      M0,-80
      Q10,-75 0,-70
      Q-10,-65 0,-60
      Q10,-55 0,-50
      Q-10,-45 0,-40
      Q10,-35 0,-30
      Q-10,-25 0,-20
      Q10,-15 0,-10
      Q-10,-5 0,0
      Q10,5 0,10
      Q-10,15 0,20
      Q10,25 0,30
      Q-10,35 0,40
      Q10,45 0,50
      Q-10,55 0,60
      Q10,65 0,70
      Q-10,75 0,80
      Q10,85 0,90
      V130
    `);
  });
</script>
</body>
</html>