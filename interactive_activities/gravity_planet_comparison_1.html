<html>
<head>
<style>
  body { margin: 0; padding: 0; background: #f0f4f8; overflow: hidden; display: flex; align-items: center; justify-content: center; height: 100vh; font-family: 'Segoe UI', sans-serif; }
  svg { max-width: 100%; max-height: 100%; box-shadow: 0 4px 12px rgba(0,0,0,0.1); background: #ffffff; border-radius: 8px; user-select: none; }
  .clickable { cursor: pointer; transition: opacity 0.2s; }
  .clickable:hover { opacity: 0.8; }
  .btn-hover:hover { fill: #2563EB; }
  .btn-active { fill: #1E40AF; }
</style>
</head>
<body>

<svg viewBox="0 0 600 600" width="600" height="600" preserveAspectRatio="xMidYMid meet" id="labSvg">
  <!-- Definitions -->
  <defs>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur in="SourceAlpha" stdDeviation="2"/>
      <feOffset dx="0" dy="2" result="offsetblur"/>
      <feComponentTransfer>
        <feFuncA type="linear" slope="0.3"/>
      </feComponentTransfer>
      <feMerge>
        <feMergeNode/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  </defs>

  <!-- Background Grid/Layout -->
  <rect width="600" height="600" fill="#F8FAFC" />
  
  <!-- Floor -->
  <rect x="0" y="550" width="600" height="50" fill="#334155" />
  <line x1="0" y1="550" x2="600" y2="550" stroke="#1E293B" stroke-width="2"/>

  <!-- Ruler (Left Side) -->
  <g transform="translate(40, 100)">
    <line x1="0" y1="0" x2="0" y2="450" stroke="#94A3B8" stroke-width="2" />
    <!-- Ticks -->
    <line x1="-5" y1="0" x2="5" y2="0" stroke="#64748B" stroke-width="2"/>
    <text x="-10" y="5" text-anchor="end" font-size="12" fill="#64748B">0m</text>
    
    <line x1="-5" y1="112.5" x2="5" y2="112.5" stroke="#64748B" stroke-width="1"/>
    <text x="-10" y="117.5" text-anchor="end" font-size="12" fill="#64748B">10m</text>

    <line x1="-5" y1="225" x2="5" y2="225" stroke="#64748B" stroke-width="1"/>
    <text x="-10" y="230" text-anchor="end" font-size="12" fill="#64748B">20m</text>
    
    <line x1="-5" y1="337.5" x2="5" y2="337.5" stroke="#64748B" stroke-width="1"/>
    <text x="-10" y="342.5" text-anchor="end" font-size="12" fill="#64748B">30m</text>

    <line x1="-5" y1="450" x2="5" y2="450" stroke="#64748B" stroke-width="2"/>
    <text x="-10" y="455" text-anchor="end" font-size="12" fill="#64748B">40m</text>
  </g>

  <!-- Drop Zone Indicator -->
  <line x1="300" y1="100" x2="300" y2="550" stroke="#E2E8F0" stroke-width="2" stroke-dasharray="5,5" />
  <line x1="260" y1="100" x2="340" y2="100" stroke="#CBD5E1" stroke-width="2" />

  <!-- Selector Panel (Top Right) -->
  <rect x="380" y="20" width="200" height="90" rx="8" fill="#FFFFFF" stroke="#E2E8F0" />
  <text x="480" y="45" text-anchor="middle" font-size="12" font-weight="bold" fill="#475569">SELECT MASS</text>
  
  <g id="ballOption1" class="clickable" transform="translate(420, 75)" onclick="selectBall(1)">
    <circle r="15" fill="#EF4444" filter="url(#shadow)"/>
    <text y="30" text-anchor="middle" font-size="10" fill="#64748B">1kg</text>
  </g>
  
  <g id="ballOption2" class="clickable" transform="translate(480, 75)" onclick="selectBall(2)">
    <circle r="20" fill="#3B82F6" filter="url(#shadow)"/>
    <text y="30" text-anchor="middle" font-size="10" fill="#64748B">5kg</text>
  </g>
  
  <g id="ballOption3" class="clickable" transform="translate(540, 75)" onclick="selectBall(3)">
    <circle r="25" fill="#10B981" filter="url(#shadow)"/>
    <text y="30" text-anchor="middle" font-size="10" fill="#64748B">10kg</text>
  </g>

  <!-- Timer Display (Top Left Center) -->
  <rect x="230" y="30" width="140" height="50" rx="4" fill="#1E293B" />
  <text id="timerText" x="300" y="65" text-anchor="middle" font-family="monospace" font-size="24" fill="#00FF00" letter-spacing="2">0.00s</text>

  <!-- Active Ball (Initially Hidden) -->
  <g id="activeBallGroup" style="display:none" transform="translate(300, 100)">
    <circle id="activeBallShape" r="20" fill="#EF4444" filter="url(#shadow)"/>
    <text id="activeBallLabel" x="0" y="5" text-anchor="middle" font-size="10" fill="white" font-weight="bold"></text>
  </g>

  <!-- Drop Button -->
  <g id="btnDrop" class="clickable" transform="translate(250, 480)" onclick="dropBall()">
    <rect x="0" y="0" width="100" height="40" rx="20" fill="#3B82F6" class="btn-hover"/>
    <text x="50" y="25" text-anchor="middle" font-size="14" font-weight="bold" fill="white">DROP</text>
  </g>

  <!-- Reset Button (Hidden until needed) -->
  <g id="btnReset" class="clickable" transform="translate(250, 480)" onclick="resetSim()" style="display:none">
    <rect x="0" y="0" width="100" height="40" rx="20" fill="#64748B" class="btn-hover"/>
    <text x="50" y="25" text-anchor="middle" font-size="14" font-weight="bold" fill="white">RESET</text>
  </g>
  
  <!-- Info Text -->
  <text x="300" y="580" text-anchor="middle" font-size="12" fill="#94A3B8">Gravity (g) = 9.8 m/sÂ²</text>

</svg>

<script>
  // Config
  const GRAVITY = 9.8; // m/s^2
  const PIXELS_PER_METER = 450 / 40; // 450px height = 40m
  const FLOOR_Y = 550;
  const START_Y = 100;
  const DROP_HEIGHT_METERS = 40;
  
  // State
  let currentBallId = null;
  let isDropping = false;
  let animationFrame;
  let startTime;
  
  // Elements
  const activeBallGroup = document.getElementById('activeBallGroup');
  const activeBallShape = document.getElementById('activeBallShape');
  const activeBallLabel = document.getElementById('activeBallLabel');
  const timerText = document.getElementById('timerText');
  const btnDrop = document.getElementById('btnDrop');
  const btnReset = document.getElementById('btnReset');
  
  // Ball Data
  const balls = {
    1: { color: '#EF4444', r: 15, label: '1kg' },
    2: { color: '#3B82F6', r: 20, label: '5kg' },
    3: { color: '#10B981', r: 25, label: '10kg' }
  };

  function selectBall(id) {
    if (isDropping) return;
    
    currentBallId = id;
    const data = balls[id];
    
    // Update visual
    activeBallShape.setAttribute('fill', data.color);
    activeBallShape.setAttribute('r', data.r);
    // Adjust label position slightly based on size
    activeBallLabel.textContent = data.label;
    
    // Reset position
    activeBallGroup.setAttribute('transform', `translate(300, ${START_Y})`);
    activeBallGroup.style.display = 'block';
    
    // Reset Timer
    timerText.textContent = "0.00s";
    
    // Ensure drop button is shown
    btnDrop.style.display = 'block';
    btnReset.style.display = 'none';
  }

  function dropBall() {
    if (!currentBallId || isDropping) {
        if (!currentBallId) alert("Please select a mass first.");
        return;
    }
    
    isDropping = true;
    startTime = performance.now();
    
    // Disable interaction
    btnDrop.style.opacity = "0.5";
    btnDrop.style.pointerEvents = "none";
    
    animate();
  }

  function animate() {
    const now = performance.now();
    const timeElapsedSec = (now - startTime) / 1000;
    
    // Physics: d = 0.5 * g * t^2
    const distanceMeters = 0.5 * GRAVITY * Math.pow(timeElapsedSec, 2);
    const pixelDrop = distanceMeters * PIXELS_PER_METER;
    const currentY = START_Y + pixelDrop;
    
    // Check collision (accounting for ball radius)
    const radius = balls[currentBallId].r;
    const hitY = FLOOR_Y - radius;
    
    // Update Timer
    timerText.textContent = timeElapsedSec.toFixed(2) + "s";
    
    if (currentY >= hitY) {
      // Impact
      activeBallGroup.setAttribute('transform', `translate(300, ${hitY})`);
      
      // Calculate exact theoretical time for display consistency
      // t = sqrt(2d/g)
      const exactTime = Math.sqrt((2 * DROP_HEIGHT_METERS) / GRAVITY);
      timerText.textContent = exactTime.toFixed(2) + "s";
      
      endDrop();
    } else {
      activeBallGroup.setAttribute('transform', `translate(300, ${currentY})`);
      animationFrame = requestAnimationFrame(animate);
    }
  }

  function endDrop() {
    isDropping = false;
    cancelAnimationFrame(animationFrame);
    
    // Swap buttons
    btnDrop.style.display = 'none';
    btnDrop.style.opacity = "1";
    btnDrop.style.pointerEvents = "auto";
    
    btnReset.style.display = 'block';
  }

  function resetSim() {
    // Return ball to top
    activeBallGroup.setAttribute('transform', `translate(300, ${START_Y})`);
    timerText.textContent = "0.00s";
    
    // Swap buttons back
    btnReset.style.display = 'none';
    btnDrop.style.display = 'block';
  }

</script>
</body>
</html>